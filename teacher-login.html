<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login Page</title>
  <!-- Bootstrap CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div id="app" class="container mt-5">
  <form @submit.prevent="login" class="border p-4">
     <h3 class="h3 text-primary">Teacher Login </h3>
    <div class="form-group">
      <label for="phone">Phone:</label>
      <input type="text" class="form-control shadow-none" id="phone" v-model="phone" required>
    </div>
    <div class="form-group">
      <label for="password">Password:</label>
      <input type="password" class="form-control shadow-none" id="password" v-model="password" required>
    </div>
    <button type="submit" class="btn btn-primary w-100 d-block" :disabled="isLoading">
      <span v-if="isLoading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
      <span>{{ isLoading ? 'Loading' : 'Login' }}</span>
    </button>
  </form>
  <div aria-live="polite" aria-atomic="true" style="position: relative; min-height: 200px;">
  <div class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-autohide="false">
    <div class="toast-header">
      <strong class="mr-auto">Notification</strong>
      <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="toast-body">
      <!-- Toast message will appear here -->
    </div>
  </div>
</div>

</div>

<!-- Vue.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
<!-- Axios CDN -->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
  new Vue({
    el: '#app',
    data: {
      phone: '0466577865',
      password: '111111',
      isLoading: false,
    },
    methods: {
      async login() {
        this.isLoading = true;
        try {
          const response = await axios.post('https://madrasa-back.vercel.app/api/teacher/login', {
            phone: this.phone,
            password: this.password
          });

          const { token, user } = response.data;

          // Store token and user in localStorage
          localStorage.setItem('token', token);
          localStorage.setItem('user', JSON.stringify(user));

          // Redirect to dashboard after successful login
          this.showToast('Login successful!', 'toast-success');
          
          // Redirect to dashboard after successful login
          setTimeout(() => {
             window.location.href = './teacher/dashboard.html';
          }, 1500);
        } catch (error) {
          console.error(error.response.data.error);
          // Handle login errors
        } finally {
          this.isLoading = false;
        }
      },
      showToast(message, type) {
         const toast = document.querySelector('.toast');
         const toastBody = document.querySelector('.toast-body');
      
         // Update toast message and type
         toastBody.textContent = message;
         toast.classList.remove('toast-success', 'toast-error');
         toast.classList.add(type);
      
         // Show toast
         const bsToast = new bootstrap.Toast(toast);
         bsToast.show();
      }
    }
  });
</script>
</body>
</html>
